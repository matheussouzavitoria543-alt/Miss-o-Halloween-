<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Progresso em Foco</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/feather-icons"></script>
<style>
  .progress-bar { transition: width 0.5s ease-in-out; }
  .notification { animation: slideIn 0.5s forwards, fadeOut 0.5s 2.5s forwards; }
  @keyframes slideIn { from { transform: translateY(-100px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
  @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
</style>
</head>
<body class="bg-gray-50 min-h-screen">

<!-- Notificação -->
<div id="notification" class="notification fixed top-4 left-1/2 transform -translate-x-1/2 z-50 hidden">
  <div class="bg-blue-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center">
    <i data-feather="alert-circle" class="mr-2"></i>
    <span id="notification-message"></span>
  </div>
</div>

<!-- Modal Configurações Membros -->
<div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white rounded-xl shadow-xl p-8 w-full max-w-md">
    <div class="flex justify-between items-center mb-6 border-b pb-4">
      <h3 class="text-2xl font-bold text-gray-800">Configurações</h3>
      <button onclick="closeSettingsModal()" class="text-gray-500 hover:text-gray-700">
        <i data-feather="x" class="w-6 h-6"></i>
      </button>
    </div>

    <div class="space-y-6">
      <!-- Nome do membro -->
      <div>
        <h4 class="font-semibold mb-2">Seu Nome</h4>
        <input id="memberNameInput" type="text" placeholder="Digite seu nome" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500">
        <button onclick="saveMemberName()" class="mt-2 w-full bg-blue-500 text-white py-2 rounded hover:bg-blue-600">Salvar Nome</button>
      </div>

      <!-- Tema do Sistema -->
      <div>
        <h4 class="font-semibold mb-2">Tema do Sistema</h4>
        <div class="flex gap-3 mb-4">
          <button onclick="changeThemeColor('#3B82F6')" class="w-10 h-10 rounded-lg bg-blue-500"></button>
          <button onclick="changeThemeColor('#10B981')" class="w-10 h-10 rounded-lg bg-green-500"></button>
          <button onclick="changeThemeColor('#F59E0B')" class="w-10 h-10 rounded-lg bg-yellow-500"></button>
          <button onclick="changeThemeColor('#EF4444')" class="w-10 h-10 rounded-lg bg-red-500"></button>
          <button onclick="changeThemeColor('#8B5CF6')" class="w-10 h-10 rounded-lg bg-purple-500"></button>
        </div>

        <h4 class="font-semibold mb-2">Cor das Barras</h4>
        <div class="flex gap-3">
          <button onclick="changeBarColor('#3B82F6')" class="w-10 h-10 rounded-lg bg-blue-500"></button>
          <button onclick="changeBarColor('#10B981')" class="w-10 h-10 rounded-lg bg-green-500"></button>
          <button onclick="changeBarColor('#F59E0B')" class="w-10 h-10 rounded-lg bg-yellow-500"></button>
          <button onclick="changeBarColor('#EF4444')" class="w-10 h-10 rounded-lg bg-red-500"></button>
          <button onclick="changeBarColor('#8B5CF6')" class="w-10 h-10 rounded-lg bg-purple-500"></button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Header -->
<div class="container mx-auto px-4 py-8">
  <header class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold text-blue-500">Progresso em Foco</h1>
    <div class="flex space-x-4">
      <button onclick="openSettingsModal()" class="p-2 rounded-full hover:bg-gray-200">
        <i data-feather="settings"></i>
      </button>
    </div>
  </header>

  <!-- Barras -->
  <div id="barsContainer" class="space-y-6"></div>
</div>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
  import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDun-EEYvE7pUYtJCS7APB6J4xSD-gN0oE",
    authDomain: "famous-city-rp.firebaseapp.com",
    databaseURL: "https://famous-city-rp-default-rtdb.firebaseio.com",
    projectId: "famous-city-rp",
    storageBucket: "famous-city-rp.firebasestorage.app",
    messagingSenderId: "938453127813",
    appId: "1:938453127813:web:a3b9b977039a39babacfec",
    measurementId: "G-HQ8SGS11BP"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Funções de modal
  function openSettingsModal(){ document.getElementById('settingsModal').classList.remove('hidden'); }
  function closeSettingsModal(){ document.getElementById('settingsModal').classList.add('hidden'); }

  // Cores
  function changeThemeColor(color){ document.documentElement.style.setProperty('--color-primary', color); }
  function changeBarColor(color){ barColor = color; renderBars(); }

  // Salvar nome do membro no Firebase
  function saveMemberName(){
    const name = document.getElementById('memberNameInput').value.trim();
    if(!name){ alert('Digite seu nome'); return; }
    set(ref(db, 'memberName'), name);
    showNotification(`Nome salvo: ${name}`);
    closeSettingsModal();
  }

  // Notificação
  function showNotification(msg){
    const el = document.getElementById('notification');
    document.getElementById('notification-message').textContent = msg;
    el.classList.remove('hidden');
    setTimeout(()=>el.classList.add('hidden'), 2500);
  }

  // Barras
  let bars = [];
  let barColor = '#3B82F6';

  function renderBars(){
    const container = document.getElementById('barsContainer');
    container.innerHTML = '';
    bars.forEach((b, i)=>{
      const div = document.createElement('div');
      div.className = 'bg-white rounded-lg shadow p-6';
      div.innerHTML = `
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-lg font-semibold">${b.name} <span class="text-sm text-gray-500">(${b.member||'Membro'})</span></h3>
        </div>
        <div class="flex items-center space-x-4 mb-2">
          <div class="flex-1 h-4 bg-gray-200 rounded-full overflow-hidden">
            <div class="progress-bar h-full rounded-full" style="width:${b.progress}%; background-color:${barColor}"></div>
          </div>
          <span>${b.progress}%</span>
        </div>
      `;
      container.appendChild(div);
    });
  }

  // Puxar dados do Firebase em tempo real
  onValue(ref(db, 'bars'), (snapshot)=>{
    bars = snapshot.val() || [];
    renderBars();
  });

  feather.replace();
</script>
</body>
</html>
